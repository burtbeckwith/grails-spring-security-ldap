<html>
    <head>
        <title>spring-security-ldap 0.1.1 - Reference Documentation</title>
        <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen" title="Style" charset="utf-8"/>
        <link rel="stylesheet" href="../css/pdf.css" type="text/css" media="print" title="PDF" charset="utf-8" />
    </head>
    <body class="body">
        <div id="header">
            <div class="images"><br/><br/>
                <a href="http://grails.org" target="_blank"><img alt="The Grails Framework" src="../img/grails.png" border="0"/></a>
                <span style="right:30px; top:20px; position:absolute;">
                    <a href="../index.html" target="_top">Frames</a> | <a href="index.html" target="_top">No Frames</a><br/><br/>
                    <a href="http://springsource.com" target="_blank"><img alt="SpringSource - A Division of VMware" src="../img/springsource-logo.png" border="0"/></a>
                </span>
            </div>
            <div class="message">spring-security-ldap</div>
            <h1>spring-security-ldap - Reference Documentation</h1>
            <p><strong>Authors:</strong> Burt Beckwith</p>
            <p><strong>Version:</strong> 0.1.1</p>
            <em></em>
        </div>

        <div id="toc">
            <h2>Table of Contents</h2>
            <div class="tocItem" style="margin-left:0px"><a href="#1. Introduction">1. Introduction</a></div><div class="tocItem" style="margin-left:10px"><a href="#1.1 History">1.1 History</a></div><div class="tocItem" style="margin-left:0px"><a href="#2. Usage">2. Usage</a></div><div class="tocItem" style="margin-left:0px"><a href="#3. Configuration">3. Configuration</a></div>
        </div>
        <div id="content">
            <h1><a name="1. Introduction">1. Introduction</a></h1>The LDAP plugin adds support for LDAP and Active Directory authentication to a Grails application that uses Spring Security. It depends on the <a href="http://grails.org/plugin/spring-security-core" target="blank">Spring Security Core plugin</a>.<p class="paragraph"/>Once you have configured your Grails application as an LDAP client you can delegate authentication to LDAP and not have to manage users' authentication information in your application. By default roles are inferred from LDAP group membership and you can store additional application-specific roles in your database.<p class="paragraph"/>Please refer to the <a href="http://static.springsource.org/spring-security/site/docs/3.0.x/reference/ldap.html" target="blank">Spring Security LDAP documentation</a> for details of the underlying implementation.
<h2><a name="1.1 History">1.1 History</a></h2><ul class="star">
<li>Version 0.1</li>
<ul class="star">
<li>released 06/18/2010</li>
</ul></ul><p class="paragraph"/><h1><a name="2. Usage">2. Usage</a></h1><blockquote class="note">
Configuring your LDAP server is beyond the scope of this document. There are many different approaches and this will most likely be done by IT staff. It's assumed here that you already have a running LDAP or Active Directory server.
</blockquote><p class="paragraph"/>There isn't much that you need to do in your application to use LDAP. Just install this plugin, and configure any required parameters and whatever optional parameters you want in Config.groovy. These are described in detail in <a href="../guide/single.html#3. Configuration" class="guide">Chapter 3</a> but typically you only need to set these properties<p class="paragraph"/><div class="code"><pre>grails.plugins.springsecurity.ldap.context.managerDn = 'uid=admin,ou=system'
grails.plugins.springsecurity.ldap.context.managerPassword = 'secret'
grails.plugins.springsecurity.ldap.context.server = 'ldap://localhost:10389'
grails.plugins.springsecurity.ldap.authorities.groupSearchBase = 'ou=groups,dc=yourcompany,dc=com'
grails.plugins.springsecurity.ldap.search.base = 'dc=yourcompany,dc=com'</pre></div><p class="paragraph"/>Often all role information will be stored in LDAP, but if you want to also assign application-specific roles to users in the database, then add this<p class="paragraph"/><div class="code"><pre>grails.plugins.springsecurity.ldap.authorities.retrieveDatabaseRoles = <span class="java&#45;keyword">true</span></pre></div><p class="paragraph"/>to do an extra database lookup after the LDAP lookup.<p class="paragraph"/>Depending on how passwords are encrypted in LDAP you may also need to configure the encryption algorithm, e.g.<p class="paragraph"/><div class="code"><pre>grails.plugins.springsecurity.password.algorithm = 'SHA&#45;256'</pre></div><p class="paragraph"/><h4>Custom UserDetailsContextMapper</h4><p class="paragraph"/>There are three options for mapping LDAP attributes to <code>UserDetails</code> data (as specified by the <code>grails.plugins.springsecurity.ldap.mapper.userDetailsClass</code> config attribute) and hopefully one of those will be sufficient for your needs. If not, it's easy to implement <a href="http://static.springsource.org/spring-security/site/docs/3.0.x/apidocs/org/springframework/security/ldap/userdetails/UserDetailsContextMapper.html" target="blank">UserDetailsContextMapper</a> yourself.<p class="paragraph"/>Create a class in <code>src/groovy</code> or <code>src/java</code> that implements <a href="http://static.springsource.org/spring-security/site/docs/3.0.x/apidocs/org/springframework/security/ldap/userdetails/UserDetailsContextMapper.html" target="blank">UserDetailsContextMapper</a> and register it in <code>grails-app/conf/spring/resources.groovy</code>:<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">import</span> com.mycompany.myapp.MyUserDetailsContextMapper<p class="paragraph"/>beans = &#123;
   ldapUserDetailsMapper(MyUserDetailsContextMapper) &#123;
      // bean attributes
   &#125;
&#125;</pre></div><p class="paragraph"/><h1><a name="3. Configuration">3. Configuration</a></h1><blockquote class="note">
Any property overrides must be specified in <code>grails-app/conf/Config.groovy</code> using the <code>grails.plugins.springsecurity</code> suffix, for example
<div class="code"><pre>grails.plugins.springsecurity.ldap.search.searchSubtree = <span class="java&#45;keyword">true</span></pre></div>
</blockquote><p class="paragraph"/>There are several configuration options for the LDAP plugin. In practice the defaults are fine and only a few will need to be overridden.<p class="paragraph"/><table class="wiki-table" cellpadding="0" cellspacing="0" border="0"><tr><th><strong class="bold">Name</strong></th><th><strong class="bold">Default</strong></th><th><strong class="bold">Meaning</strong></th></tr><tr class="table-odd"><td>ldap.search.searchSubtree</td><td><code>true</code></td><td>If <code>true</code> then searches the entire subtree as identified by context, if false (the default) then only searches the level identified by the context.</td></tr><tr class="table-even"><td>ldap.search.base</td><td>''</td><td>Context name to search in, relative to the base of the configured ContextSource, e.g. 'dc=example,dc=com', 'ou=users,dc=example,dc=com'</td></tr><tr class="table-odd"><td>ldap.search.filter</td><td><code>'(uid={0})'</code></td><td>The filter expression used in the user search</td></tr><tr class="table-even"><td>ldap.search.derefLink</td><td><code>false</code></td><td>Enables/disables link dereferencing during the search</td></tr><tr class="table-odd"><td>ldap.search.timeLimit</td><td><code>0</code> (unlimited)</td><td>The time to wait before the search fails</td></tr><tr class="table-even"><td>ldap.search.attributesToReturn</td><td><code>null</code> (all)</td><td>The attributes to return as part of the search</td></tr><tr class="table-odd"><td>ldap.authenticator.useBind</td><td><code>true</code></td><td>if <code>true</code> uses a <code>BindAuthenticator</code> to bind as the authenticating user, if <code>false</code> uses a <code>PasswordComparisonAuthenticator</code> to lookup the user login name and compare passwords</td></tr><tr class="table-even"><td>ldap.authenticator.attributesToReturn</td><td><code>null</code> (all)</td><td>names of attribute ids to return; use <code>null</code> to return all and an empty list to return none</td></tr><tr class="table-odd"><td>ldap.authenticator.dnPatterns</td><td><code>null</code> (none)</td><td>optional pattern(s) used to create DN search patterns, e.g. &#91;"cn={0},ou=people"&#93;</td></tr><tr class="table-even"><td>ldap.authenticator.passwordAttributeName</td><td><code>'userPassword'</code></td><td>the name of the password attribute to use when <code>useBind</code> = <code>false</code></td></tr><tr class="table-odd"><td>ldap.mapper.convertToUpperCase</td><td><code>true</code></td><td>whether to uppercase retrieved role names (will also be prefixed with "ROLE_")</td></tr><tr class="table-even"><td>ldap.mapper.passwordAttributeName</td><td><code>'userPassword'</code></td><td>password attribute name to use when building the <code>UserDetails</code></td></tr><tr class="table-odd"><td>ldap.mapper.userDetailsClass</td><td><code>null</code> (create an LdapUserDetailsImpl)</td><td>use <code>'person'</code> to create a <code>Person</code>, <code>'inetOrgPerson'</code> to create an <code>InetOrgPerson</code>, or <code>null</code> to create an <code>LdapUserDetailsImpl</code></td></tr><tr class="table-even"><td>ldap.mapper.roleAttributes</td><td><code>null</code></td><td>optional names of role attributes</td></tr><tr class="table-odd"><td>ldap.auth.hideUserNotFoundExceptions</td><td><code>true</code></td><td>if <code>true</code> throw a new <code>BadCredentialsException</code>, otherwise throw the original <code>UsernameNotFoundException</code></td></tr><tr class="table-even"><td>ldap.auth.useAuthPassword</td><td><code>true</code></td><td>If <code>true</code> use the supplied password as the credentials in the authenticationtoken, otherwise obtain the password from the UserDetails object (it may not be possible to read the password from the directory)</td></tr><tr class="table-odd"><td>ldap.context.managerDn</td><td><code>'cn=admin,dc=example,dc=com'</code></td><td>DN to authenticate with</td></tr><tr class="table-even"><td>ldap.context.managerPassword</td><td><code>'secret'</code></td><td>username to authenticate with</td></tr><tr class="table-odd"><td>ldap.context.server</td><td><code>'ldap://localhost:389'</code></td><td>address of the LDAP server</td></tr><tr class="table-even"><td>ldap.context.contextFactoryClassName</td><td><code>'com.sun.jndi.ldap.LdapCtxFactory'</code></td><td>class name of the <code>InitialContextFactory</code> to use</td></tr><tr class="table-odd"><td>ldap.context.dirObjectFactoryClassName</td><td><a href="http://static.springsource.org/spring-ldap/site/apidocs/org/springframework/ldap/core/support/DefaultDirObjectFactory.html" target="blank">DefaultDirObjectFactory</a></td><td>class name of the <code></code>DirObjectFactory to use</td></tr><tr class="table-even"><td>ldap.context.baseEnvironmentProperties</td><td>none</td><td>extra context properties</td></tr><tr class="table-odd"><td>ldap.context.cacheEnvironmentProperties</td><td><code>true</code></td><td>whether environment properties should be cached between requsts</td></tr><tr class="table-even"><td>ldap.context.anonymousReadOnly</td><td><code>false</code></td><td>whether an anonymous environment should be used for read-only operations</td></tr><tr class="table-odd"><td>ldap.context.referral</td><td><code>null</code> ('ignore')</td><td>the method to handle referrals. Can be <code>'ignore'</code> or <code>'follow'</code> to enable referrals to be automatically followed</td></tr><tr class="table-even"><td>ldap.authorities.retrieveGroupRoles</td><td><code>true</code></td><td>whether to infer roles based on group membership</td></tr><tr class="table-odd"><td>ldap.authorities.retrieveDatabaseRoles</td><td><code>false</code></td><td>whether to retrieve additional roles from the database using the User/Role many-to-many</td></tr><tr class="table-even"><td>ldap.authorities.groupRoleAttribute</td><td><code>'cn'</code></td><td>The ID of the attribute which contains the role name for a group</td></tr><tr class="table-odd"><td>ldap.authorities.groupSearchFilter</td><td><code>'uniquemember={0}'</code></td><td>The pattern to be used for the user search. {0} is the user's DN</td></tr><tr class="table-even"><td>ldap.authorities.searchSubtree</td><td><code>true</code></td><td>If <code>true</code> a subtree scope search will be performed, otherwise a single-level search is used</td></tr><tr class="table-odd"><td>ldap.authorities.groupSearchBase</td><td><code>'ou=groups,dc=example,dc=com'</code></td><td>The base DN from which the search for group membership should be performed</td></tr><tr class="table-even"><td>ldap.authorities.ignorePartialResultException</td><td><code>false</code></td><td>Whether <code>PartialResultException</code>s should be ignored in searches, typically used with Active Directory since AD servers often have a problem with referrals.</td></tr><tr class="table-odd"><td>ldap.authorities.defaultRole</td><td>none</td><td>An optional default role to be assigned to all users</td></tr></table><p class="paragraph"/>
        </div>
        <div id="footer">
             
        </div>
    
<script type="text/javascript">
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-16219500-1']);
	_gaq.push(['_trackPageview']);

	(function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	})();
</script>
</body>
</html>
